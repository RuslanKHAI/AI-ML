# EDA и визуализация
## Основные выводы
### Анализ визуализации попарных числовых признаков.
Выявлены следующие зависимости меджду целевой переменной (selling price) и характеристиками автомобиля:
1. Прямая связь между ценой и годом выпуска автомобиля (новая машина стоит дороже)
2. Прямая связь цены с мощностью, объемом двигателя и крутящим моментом. Чем больше данные показатели, тем дороже автомобиль.
3. Обратная связь между ценой и количеством мест. На графике наблюдаем снижение цены при увеличении посадочных мест свыше 5. Возможно на это так же влияет низкая мощность и крутящий момент при объеме двигателя от 2000 до 3000куб.м. Скорее всего автомобиль с большим количесвом посадочных мест относится к семейному классу так как наблюдается небольшой пробег. Если автомобиль использоавлся в рабочих целях то пробег был бы существенно больше.
4. Обратная связь между ценой и пробегом (чем выше пробег, тем дешевле машина).
5. Наблюдаю слабую кореляюцию между ценой и расходом топлива.

Ниже представлены визуализации данных 
train
![visual train](https://github.com/user-attachments/assets/9c5d8770-d41b-4a30-a6a8-a6b9d7fb9f54)
 test
![visual_test](https://github.com/user-attachments/assets/8715e172-4eaf-47fc-818e-664440c7cc05)

### В задании 7 проведена численная оценка связей параметров. В результате анализа получены следующие коэффициенты корреляции:
![cor](https://github.com/user-attachments/assets/525135ef-ae57-4077-af8a-ec2ff23e105f)

1. Наименее скоррелированы между собой два показателя это год и объем двигателя (коэффициент корреляции = 0). Это связано с тем, что каждый год выпускаются почти одинаковые наборы двигателей по объему для удволетворения всех классов потребителей (и соответсственно не наблюдается что в какой-то год стали пользоваться поплуярностью двигатели с определнным объемом).
2. Сильно скоррелированы мощность, крутящий момент,объем двигателя, а так же мощност и цена. Все факторы очевидно взаимосвязаны. Для построения модели можно использовать фактор - мощность, так как наиболее скоррелирован с ценой.
3. Можно утверждать что чем старше автомобиль, тем выше пробег. Об обратной связи свидетельствует отрицательный коэффициент корреляции = -0.37.

### Проведен дополнительный анализ параметров.
![visual add](https://github.com/user-attachments/assets/577eec0d-3d49-494f-9228-d89f4297293a)

   На графике видно, что мощные двигатели в основном используют Дизельное топливо и бензин. Двигатели на газе не дают высокую мощность. Это связано с тем что при сгорании газа выделяется меньше теплоты.

# Часть 2 | Модель только на вещественных признаках. 
### Регрессионный анализ  
#### Линейная регрессия (со стандартизайией и без)
Провели обучение модели классической линейной регрессии с дефолтными параметрами
- Rsquared (train):  54.2%
- Rsquared (test):   57.0%
  
Попробовали улучшить модель стандартизацией:
- Rsquared (train):  54.2%
- Rsquared (test):   57.0%
Стандартизация не помогла  прибавить в качестве. Изменения не произошли.  

В задании 11 выявили важность признаков в модели. Чем больше коэффициент  βi  по модулю, тем важнее признак.
Наиболее информативным признаком в предсказании цены с наибольшим коэффициентом является: max_power (коэффициент: 333801.0896067262)

#### Модель Lasso-регрессии
В задании 12 пробуем улучшить модель с помощью применения регуляризации. Для этого используем Lasso регрессию.
- Mean Squared Error train: 131,309,365,571.5
- Mean Squared Error test:  246,914,552,256.7
- Rsquared train:  54.2 %
- Rsquared test:   57.0 %

Модель не занулила веса. Оставшиеся признаки существены для прогноза. Увеличение Альфа до 5 не поменяла ситуацию.
Перебором по сетке (c 10-ю фолдами, класс GridSearchCV) оптимальные параметры для Lasso-регрессии привели к незначительному (незначемому) улучшению
- Rsquared train:  54.2%
- Rsquared test:   56.9%

   Коэффициенты также не занулились. 
#### Модель Ridge-регрессии
Добавили качественные переменные и использовали Ridge регрессию. Обогатили данные новой ифнормацией, изменили подход к регуляризации. 
Показатели при применении Ridge 
- Mean Squared Error  train: 97,095,205,325.2
- Mean Squared Error  test:  201,661,972,550.5
- Rsquared train:  66.1%
- Rsquared test:   64.9%

Качество модели лучше: Rsquared test увеличился с 57% до 65%, ean Squared Error test: снизился до 201 с 247 млн.
# Часть 4. | Бизнесовая
По средством реализации метрики business_metric произвели расчет доли прогнозов среди всех цен на авто, отличающихся от реальных цен на эти авто не более чем на 10% (в одну или другую сторону), для всех обученных моделей.
Результаты расчета:
- linear regression (без стандартизации): 82.0
- linear regression (со стандартизацией): 82.0
- Lasso: 81.9
- Ridge регрессия: 75.3
# Выводы: 
- Стандартизация данных не повлияла на результат линейной регрессии
- Lasso и Ridge регрессия показали некоторое улучшение. Lasso и Ridge, будучи методами регуляризации, способны лучше справляться с переобучением и шумом в данных по сравнению с обычной линейной регрессией. 
- Ridge дает наиболее заметное улучшение.
